link(rel='stylesheet', href='/stylesheets/style.css')
script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js')
script(src='socket.io/socket.io.js')
script
    var current_user;
    var socket = io.connect('http://localhost:3000');
    socket.on('connect', function(){
        socket.emit('init');
        socket.emit('set nickname');
    });
    socket.on('updatechat', function (user, data) {
        $('#conversation').append('<b>'+ user + ':</b> ' + data + '<br>');
    });
    socket.on('updateusers', function(data){
        $('#users').empty();
        for(var i = data.length-1; i >= 0; --i){
            if(data[i] != undefined){
                $('#users').append( data[i] + '<br>');
            }
        }
    });
    socket.on('disconnect', function(){
        socket.emit('log_out');
    });
    $(function(){
        $('#datasend').click(function() {
            var message = $('#data').val();
            $('#data').val("");
            socket.emit('sendchat', message);
        });

        $('#logout').click(function(){
            socket.emit('log_out');
        });
        $('#data').keypress(function(e){
          if(e.which == 13){
            $(this).blur();
            $('#datasend').focus().click();
          }

        });
    });
    
block content
  #container
    #userbar
      | Welcome #{username} |
      a(href='/logout', id="logout") Log Out
    #users
    #conversation
    input(type='text', id="data", style="width:200px;")
    input(type="button", id="datasend", value="send")
    
